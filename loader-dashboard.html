<!-- Loader HTML -->
<div id="loader" style="display: none;">
    <div class="spinner-5"></div>
</div>

<!-- Styles -->
<style>
    body.loading {
        overflow: hidden; /* Disable scrolling */
        height: 100vh; /* Prevent body height from expanding */
        position: fixed; /* Prevent body from moving */
        width: 100%; /* Ensure the width is 100% */
    }

    nav.close ~ .dashboard #loader {
        left: 0%;
        top: 2%;
    }

    #loader {
        position: fixed;
        left: 7%;
        top: 2%;
        width: 100%;
        height: 100%;
        background-color: var(--loader-bg); /* Semi-transparent white */
        z-index: 9999; /* Make sure the loader is on top */
        display: flex; /* Use flexbox for centering */
        justify-content: center; /* Center horizontally */
        align-items: center; /* Center vertically */
    }

    .spinner-5 {
        width: 50px;
        aspect-ratio: 1;
        display: grid;
        border: 4px solid #0000; /* Transparent border */
        border-radius: 50%;
        border-right-color: var(--loader); /* Spinner color */
        animation: s5 1s infinite linear;
    }

    .spinner-5::before,
    .spinner-5::after {
        content: "";
        grid-area: 1/1;
        margin: 2px; /* Inner margin */
        border: inherit;
        border-radius: 50%;
        animation: s5 2s infinite; /* Spinner animation */
    }

    .spinner-5::after {
        margin: 8px; /* Inner margin for the second spinner */
        animation-duration: 3s; /* Slower animation for the after pseudo-element */
    }

    @keyframes s5 { 
        100% { transform: rotate(1turn); } /* Rotate 360 degrees */
    }
</style>

<!-- jQuery Script -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        // Show loader when AJAX starts
        $(document).ajaxStart(function() {
            $("#loader").show();
            $("body").addClass("loading"); // Add class to disable scrolling
        }).ajaxStop(function() {
            $("#loader").hide();
            $("body").removeClass("loading"); // Remove class to enable scrolling
        });

        // Show loader when the page is loading
        $(window).on("load", function() {
            $("#loader").hide(); // Hide the loader once the page is fully loaded
            $("body").removeClass("loading"); // Ensure scrolling is enabled
        });

        // Show loader when the page is unloading
        $(window).on("beforeunload", function() {
            $("#loader").show(); // Show the loader when navigating away
            $("body").addClass("loading"); // Disable scrolling while unloading
        });

        // Disable clicking on header when loader is active
        $(document).on("click", ".header", function(e) {
            if ($("#loader").is(":visible")) {
                e.preventDefault(); // Prevent header click if loader is visible
                e.stopPropagation(); // Stop the event from bubbling up
            }
        });
    });
</script>
